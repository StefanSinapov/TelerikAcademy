(function(e){if(typeof bootstrap==="function"){bootstrap("promise",e)}else if(typeof exports==="object"){module.exports=e()}else if(typeof define==="function"&&define.amd){define(e)}else if(typeof ses!=="undefined"){if(!ses.ok()){return}else{ses.makeQ=e}}else{Q=e()}})(function(){"use strict";function o(e){var t=Function.call;return function(){return t.apply(e,arguments)}}function v(e){return e===Object(e)}function m(e){return d(e)==="[object StopIteration]"||e instanceof g}function w(t,n){if(e&&n.stack&&typeof t==="object"&&t!==null&&t.stack&&t.stack.indexOf(b)===-1){t.stack=E(t.stack)+"\n"+b+"\n"+E(n.stack)}}function E(e){var t=e.split("\n");var n=[];for(var r=0;r<t.length;++r){var i=t[r];if(!T(i)&&!S(i)&&i){n.push(i)}}return n.join("\n")}function S(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function x(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t){return[t[1],Number(t[2])]}var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n){return[n[1],Number(n[2])]}var r=/.*@(.+):(\d+)$/.exec(e);if(r){return[r[1],Number(r[2])]}}function T(e){var t=x(e);if(!t){return false}var i=t[0];var s=t[1];return i===r&&s>=n&&s<=xt}function N(){if(!e){return}try{throw new Error}catch(t){var n=t.stack.split("\n");var i=n[0].indexOf("@")>0?n[1]:n[2];var s=x(i);if(!s){return}r=s[0];return s[1]}}function C(e){return $(e)}function k(){function l(e){r=e;a(t,function(t,n){s(function(){e.promiseDispatch.apply(e,n)})},void 0);t=void 0;n=void 0}var t=[],n=[],r;var i=c(k.prototype);var o=c(A.prototype);o.promiseDispatch=function(e,i,o){var a=u(arguments);if(t){t.push(a);if(i==="when"&&o[1]){n.push(o[1])}}else{s(function(){r.promiseDispatch.apply(r,a)})}};o.valueOf=function(){if(t){return o}var e=O(r);if(M(e)){r=e}return e};if(C.longStackJumpLimit>0&&e){try{throw new Error}catch(f){o.stack=f.stack.substring(f.stack.indexOf("\n")+1)}}i.promise=o;i.resolve=function(e){if(r){return}l($(e))};i.fulfill=function(e){if(r){return}l(V(e))};i.reject=function(e){if(r){return}l(X(e))};i.notify=function(e){if(r){return}a(n,function(t,n){s(function(){n(e)})},void 0)};return i}function L(e){if(typeof e!=="function"){throw new TypeError("resolver must be a function.")}var t=k();ot(e,t.resolve,t.reject,t.notify).fail(t.reject);return t.promise}function A(e,t,n,r,i){if(t===void 0){t=function(e){return X(new Error("Promise does not support operation: "+e))}}var s=c(A.prototype);s.promiseDispatch=function(n,r,i){var o;try{if(e[r]){o=e[r].apply(s,i)}else{o=t.call(s,r,i)}}catch(u){o=X(u)}if(n){n(o)}};if(n){s.valueOf=n}if(i){s.exception=r}return s}function O(e){if(M(e)){return e.valueOf()}return e}function M(e){return v(e)&&typeof e.promiseDispatch==="function"}function _(e){return v(e)&&typeof e.then==="function"}function D(e){return!P(e)&&!H(e)}function P(e){return!_(O(e))}function H(e){e=O(e);return M(e)&&"exception"in e}function q(){if(!F&&typeof window!=="undefined"&&!window.Touch&&window.console){console.warn("[Q] Unhandled rejection reasons (should be empty):",B)}F=true}function R(){for(var e=0;e<B.length;e++){var t=B[e];if(t&&typeof t.stack!=="undefined"){console.warn("Unhandled rejection reason:",t.stack)}else{console.warn("Unhandled rejection reason (no stack):",t)}}}function U(){B.length=0;j.length=0;F=false;if(!I){I=true;if(typeof process!=="undefined"&&process.on){process.on("exit",R)}}}function z(e,t){if(!I){return}j.push(e);B.push(t);q()}function W(e,t){if(!I){return}var n=f(j,e);if(n!==-1){j.splice(n,1);B.splice(n,1)}}function X(e){var t=A({when:function(t){if(t){W(this)}return t?t(e):this}},function(){return this},function n(){return this},e,true);z(t,e);return t}function V(e){return A({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){if(t===null||t===void 0){return e.apply(void 0,n)}else{return e[t].apply(e,n)}},apply:function(t,n){return e.apply(t,n)},keys:function(){return p(e)}},void 0,function t(){return e})}function $(e){if(M(e)){return e}e=O(e);if(_(e)){return J(e)}else{return V(e)}}function J(e){var t=k();s(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}});return t.promise}function K(e){return A({isDef:function(){}},function(n,r){return tt(e,n,r)},function(){return O(e)})}function Q(e,t,n,r){function u(e){try{return typeof t==="function"?t(e):e}catch(n){return X(n)}}function a(e){if(typeof n==="function"){w(e,l);try{return n(e)}catch(t){return X(t)}}return X(e)}function f(e){return typeof r==="function"?r(e):e}var i=k();var o=false;var l=$(e);s(function(){l.promiseDispatch(function(e){if(o){return}o=true;i.resolve(u(e))},"when",[function(e){if(o){return}o=true;i.resolve(a(e))}])});l.promiseDispatch(void 0,"when",[void 0,function(e){var t;var n=false;try{t=f(e)}catch(r){n=true;if(C.onerror){C.onerror(r)}else{throw r}}if(!n){i.notify(t)}}]);return i.promise}function G(e,t,n){return Q(e,function(e){return at(e).then(function(e){return t.apply(void 0,e)},n)},n)}function Y(e){return function(){function t(e,t){var s;if(y){try{s=n[e](t)}catch(o){return X(o)}if(s.done){return s.value}else{return Q(s.value,r,i)}}else{try{s=n[e](t)}catch(o){if(m(o)){return o.value}else{return X(o)}}return Q(s,r,i)}}var n=e.apply(this,arguments);var r=t.bind(t,"send");var i=t.bind(t,"throw");return r()}}function Z(e){throw new g(e)}function et(e){return function(){return G([this,at(arguments)],function(t,n){return e.apply(t,n)})}}function tt(e,t,n){var r=k();s(function(){$(e).promiseDispatch(r.resolve,t,n)});return r.promise}function nt(e){return function(t){var n=u(arguments,1);return tt(t,e,n)}}function it(e,t){var n=u(arguments,2);return rt(e,t,n)}function st(e,t){return tt(e,"apply",[void 0,t])}function ot(e){var t=u(arguments,1);return st(e,t)}function ut(e){var t=u(arguments,1);return function(){var r=t.concat(u(arguments));return tt(e,"apply",[this,r])}}function at(e){return Q(e,function(e){var t=0;var n=k();a(e,function(r,i,s){if(P(i)){e[s]=O(i)}else{++t;Q(i,function(r){e[s]=r;if(--t===0){n.resolve(e)}},n.reject)}},void 0);if(t===0){n.resolve(e)}return n.promise})}function ft(e){return Q(e,function(e){e=l(e,$);return Q(at(l(e,function(e){return Q(e,i,i)})),function(){return e})})}function lt(e,t){return Q(e,void 0,t)}function ct(e,t){return Q(e,void 0,void 0,t)}function ht(e,t){return Q(e,function(e){return Q(t(),function(){return e})},function(e){return Q(t(),function(){return X(e)})})}function pt(e,t,n,r){var i=function(t){s(function(){w(t,e);if(C.onerror){C.onerror(t)}else{throw t}})};var o=t||n||r?Q(e,t,n,r):e;if(typeof process==="object"&&process&&process.domain){i=process.domain.bind(i)}lt(o,i)}function dt(e,t,n){var r=k();var i=setTimeout(function(){r.reject(new Error(n||"Timed out after "+t+" ms"))},t);Q(e,function(e){clearTimeout(i);r.resolve(e)},function(e){clearTimeout(i);r.reject(e)},r.notify);return r.promise}function vt(e,t){if(t===void 0){t=e;e=void 0}var n=k();Q(e,undefined,undefined,n.notify);setTimeout(function(){n.resolve(e)},t);return n.promise}function mt(e,t){var n=u(t);var r=k();n.push(r.makeNodeResolver());st(e,n).fail(r.reject);return r.promise}function gt(e){var t=u(arguments,1);var n=k();t.push(n.makeNodeResolver());st(e,t).fail(n.reject);return n.promise}function yt(e){var t=u(arguments,1);return function(){var n=t.concat(u(arguments));var r=k();n.push(r.makeNodeResolver());st(e,n).fail(r.reject);return r.promise}}function bt(e,t){var n=u(arguments,2);return function(){function s(){return e.apply(t,arguments)}var r=n.concat(u(arguments));var i=k();r.push(i.makeNodeResolver());st(s,r).fail(i.reject);return i.promise}}function wt(e,t,n){var r=u(n||[]);var i=k();r.push(i.makeNodeResolver());rt(e,t,r).fail(i.reject);return i.promise}function Et(e,t){var n=u(arguments,2);var r=k();n.push(r.makeNodeResolver());rt(e,t,n).fail(r.reject);return r.promise}function St(e,t){if(t){e.then(function(e){s(function(){t(null,e)})},function(e){s(function(){t(e)})})}else{return e}}var e=false;try{throw new Error}catch(t){e=!!t.stack}var n=N();var r;var i=function(){};var s;if(typeof setImmediate==="function"){if(typeof window!=="undefined"){s=setImmediate.bind(window)}else{s=setImmediate}}else if(typeof process!=="undefined"&&process.nextTick){s=process.nextTick}else{(function(){function a(){--r;if(++o>=n){o=0;n*=4;var t=i&&Math.min(i-1,n);while(r<t){++r;u()}}while(i){--i;e=e.next;var s=e.task;e.task=void 0;s()}o=0}var e={task:void 0,next:null};var t=e;var n=2;var r=0;var i=0;var o=0;var u=void 0;s=function(e){t=t.next={task:e,next:null};if(r<++i&&r<n){++r;u()}};if(typeof MessageChannel!=="undefined"){var f=new MessageChannel;f.port1.onmessage=a;u=function(){f.port2.postMessage(0)}}else{u=function(){setTimeout(a,0)}}})()}var u=o(Array.prototype.slice);var a=o(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(arguments.length===1){do{if(n in this){t=this[n++];break}if(++n>=r){throw new TypeError}}while(1)}for(;n<r;n++){if(n in this){t=e(t,this[n],n)}}return t});var f=o(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++){if(this[t]===e){return t}}return-1});var l=o(Array.prototype.map||function(e,t){var n=this;var r=[];a(n,function(i,s,o){r.push(e.call(t,s,o,n))},void 0);return r});var c=Object.create||function(e){function t(){}t.prototype=e;return new t};var h=o(Object.prototype.hasOwnProperty);var p=Object.keys||function(e){var t=[];for(var n in e){if(h(e,n)){t.push(n)}}return t};var d=o(Object.prototype.toString);var g;if(typeof ReturnValue!=="undefined"){g=ReturnValue}else{g=function(e){this.value=e}}var y;try{new Function("(function* (){ yield 1; })");y=true}catch(t){y=false}C.longStackJumpLimit=1;var b="From previous event:";C.nextTick=s;C.defer=k;k.prototype.makeNodeResolver=function(){var e=this;return function(t,n){if(t){e.reject(t)}else if(arguments.length>2){e.resolve(u(arguments,1))}else{e.resolve(n)}}};C.promise=L;C.makePromise=A;A.prototype.then=function(e,t,n){return Q(this,e,t,n)};A.prototype.thenResolve=function(e){return Q(this,function(){return e})};A.prototype.thenReject=function(e){return Q(this,function(){throw e})};a(["isFulfilled","isRejected","isPending","dispatch","when","spread","get","set","del","delete","post","send","invoke","keys","fapply","fcall","fbind","all","allResolved","timeout","delay","catch","finally","fail","fin","progress","done","nfcall","nfapply","nfbind","denodeify","nbind","npost","nsend","ninvoke","nodeify"],function(e,t){A.prototype[t]=function(){return C[t].apply(C,[this].concat(u(arguments)))}},void 0);A.prototype.toSource=function(){return this.toString()};A.prototype.toString=function(){return"[object Promise]"};C.nearer=O;C.isPromise=M;C.isPromiseAlike=_;C.isPending=D;C.isFulfilled=P;C.isRejected=H;var B=[];var j=[];var F=false;var I=true;C.resetUnhandledRejections=U;C.getUnhandledReasons=function(){return B.slice()};C.stopUnhandledRejectionTracking=function(){U();if(typeof process!=="undefined"&&process.on){process.removeListener("exit",R)}I=false};U();C.reject=X;C.fulfill=V;C.resolve=$;C.master=K;C.when=Q;C.spread=G;C.async=Y;C["return"]=Z;C.promised=et;C.dispatch=tt;C.dispatcher=nt;C.get=nt("get");C.set=nt("set");C["delete"]=C.del=nt("delete");var rt=C.post=nt("post");C.send=it;C.invoke=it;C.fapply=st;C["try"]=ot;C.fcall=ot;C.fbind=ut;C.keys=nt("keys");C.all=at;C.allResolved=ft;C["catch"]=C.fail=lt;C.progress=ct;C["finally"]=C.fin=ht;C.done=pt;C.timeout=dt;C.delay=vt;C.nfapply=mt;C.nfcall=gt;C.nfbind=yt;C.denodeify=C.nfbind;C.nbind=bt;C.npost=wt;C.nsend=Et;C.ninvoke=C.nsend;C.nodeify=St;var xt=N();return C})